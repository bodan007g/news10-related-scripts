domain: "www.lemonde.fr"
language: "fr"

# Content filtering (URL-based)
content_filters:
  require_article_id: true
  article_id_pattern: '_(\d{7,})_'
  min_word_count: 200
  additional_skip_patterns:
    - "/guides-d-achat/"
    - "/applications-groupe/"
    - "/annonces-legales/"
    - "/archives-du-monde/"
    - "?origin=HPcarrousel"
    - "?lmd_campaign="

# HTML extraction rules
article_selectors:
  - ".article__content"
  - ".article-content"
  - ".post-content"
  - "[data-module=ArticleContent]"
remove_selectors:
  - ".teads-inread"
  - ".article-aside"
  - ".breadcrumb"
  - ".share-buttons"
  - ".related-articles"
  - ".social-share"
  - ".newsletter-signup"
  - ".advertising"
  - ".pub"
  - ".aside"
  - ".navigation"
  - ".header"
  - ".footer"
  - ".comments"
  - ".author-bio"
  - ".tags"
  - ".capping"  # Device limit sections
  - ".capping__wrapper"
  - ".article__gift-modal"  # Gift/subscription modals
  - ".paywall__comments"  # Paywall comment sections
  - "[id*='capping']"  # Any element with capping in the ID
  - "[class*='capping']"  # Any element with capping in the class
title_selector: "h1"
date_selector: ".meta__date, time"
author_selector: ".meta__author, .author"

# Text cleanup patterns (French-specific)
cleanup_patterns:
  subscription_walls:
    - "Il vous reste \\d+[.,]\\d*% de cet article à lire.*"
    - "La suite est réservée aux abonnés.*"
    - "Article réservé à nos abonnés.*"
    - "Pour lire la suite.*abonnez-vous.*"
    - "Parce qu'une autre personne.*est en train de lire.*Le Monde.*"
    - "Vous ne pouvez lire.*Le Monde.*que sur.*un seul appareil.*"
    - "Comment ne plus voir ce message.*"
    - "Que se passera-t-il si vous continuez à lire ici.*"
    - "Y a-t-il d'autres limites.*"
    - "Vous ignorez qui.*"
  navigation_elements:
    - "Lire aussi.*?\\|.*?Article réservé.*"
    - "Lire plus tard.*"
    - "Voir aussi.*?\\|.*"
  social_sharing:
    - "Partager cet article.*"
    - "Suivez.*?sur.*"
    - "Retrouvez.*?sur.*"
  newsletter_promotional:
    - "Recevez.*?newsletter.*"
    - "S'abonner.*?à partir de.*€.*"
  stop_at_patterns:
    - "Il vous reste \\d+[.,]\\d*%"  # Stop extraction here
  boilerplate_removal:
    - "Suivez.*?Le Monde.*"
    - "Retrouvez.*?Le Monde.*sur.*"
    - "Partager cet article.*"
    - "Lire aussi.*"
    - "Voir aussi.*"
    - "Lire plus tard.*"
    - 'Par\s+[A-ZÀ-Üa-zà-ü\s\.]+(?:,\s*[A-ZÀ-Üa-zà-ü\s\.]+)*(?:\s|$)'  # Author bylines with French chars
    - 'Publié\s+le\s+\d{1,2}/\d{1,2}/\d{4}.*'  # Publication dates
    - 'Modifié\s+le\s+\d{1,2}/\d{1,2}/\d{4}.*'  # Modification dates
    - "S'abonner.*?à partir de.*€.*"
    - "Recevez.*?newsletter.*"
    - "Lecture du.*?Monde.*?en cours sur un autre appareil.*"  # Device limit notices
    - "Continuer à lire ici.*"  # Device limit buttons
    - "Ajouter un compte.*"  # Account management
    - "Découvrir l'offre Famille.*"  # Family offers
    - "Découvrir les offres multicomptes.*"  # Multi-account offers
    - "Pourquoi voyez-vous ce message.*"  # FAQ headers
    - "modifier votre mot de passe.*"  # Password change suggestions
    - "Votre abonnement n'autorise pas.*"  # Subscription restrictions

# Custom content sections extraction
custom_content_sections:
  enabled: true
  sections:
    - name: "title"
      description: "Main article title from various possible locations"
      selectors:
        - "js:lmd.context.article.title"  # JavaScript metadata extraction
        - "h1.article__title"
        - ".article-header h1" 
        - "article h1"
        - ".post-title h1"
        - "[data-module='ArticleTitle'] h1"
        - ".headline h1"
        - "h1[class*='title']"
      fallback_selectors:
        - "h1"
        - "title"  # HTML title as last resort
      format: "# {content}"
      required: false
      order: 1
      
    - name: "subtitle"
      description: "Article subtitle or deck text"
      selectors:
        - ".article__subtitle"
        - ".article__deck"
        - ".article-header .subtitle"
        - "[data-module='ArticleSubtitle']"
        - ".post-subtitle"
        - ".headline .deck"
        - ".article__lead"
        - "h2[class*='subtitle']"
        - "p[class*='subtitle']"
        - ".article-summary"
        - "meta[name='description']"  # Meta description as primary subtitle source
      fallback_selectors:
        - "h2"
        - ".lead"
      format: "## {content}"
      required: false
      order: 2
      processing:
        # Clean meta description content
        clean_patterns:
          - "^ANALYSE\\.\\s*"  # Remove "ANALYSE. " prefix from meta descriptions
          - "^TRIBUNE\\.\\s*"  # Remove "TRIBUNE. " prefix 
          - "^CHRONIQUE\\.\\s*"  # Remove "CHRONIQUE. " prefix
          - "^OPINION\\.\\s*"  # Remove "OPINION. " prefix

    - name: "author_details"
      description: "Enhanced author information with byline"
      selectors:
        - "js:lmd.context.article.authorlist"  # JavaScript author extraction
        - ".article__author-info"
        - ".byline"
        - ".author-byline"
        - ".article__author"
        - ".meta__author"
        - "[data-module='AuthorInfo']"
      format: "*{content}*"  # Changed from "By {content}" since JS already includes "Par"
      required: false
      order: 3

  # Processing options
  processing_options:
    trim_whitespace: true
    remove_empty_sections: true
    add_separator_between_sections: true
    separator: "\n\n"
    max_section_length: 500  # Characters
    skip_duplicates: true  # Don't add if content already appears in main article